import{W as j,J as G,u as H,Z as q,r as O,Y as z,n as J,a as i,c as S,d as a,b as s,k as l,F as k,o as v,D as Q,e as h,v as b,q as g,K as W,w as X,t as w,H as Y,C as Z}from"./index-be50f945.js";const ee={class:"flex flex-column gap-3"},te=a("label",{class:"text-custom-1 font-bold"},"Quản lý sản phẩm",-1),ne={class:"flex justify-content-between"},se={class:"flex gap-2"},oe={class:"p-input-icon-right w-20rem"},ae={class:"w-full text-center"},le=["src"],re={class:"bg-main-color px-3 py-1 border-round-2xl text-white"},ie=a("div",{class:"flex justify-content-center"}," Không tìm thấy kết quả nào ",-1),ue={__name:"Product",setup(ce){const P=j(),x=G(),_=H(),{onGetterGetProducts:D,onActionGetProduct:y,onActionActiveProduct:A}=q(),t=O({tabIndex:0,body:{pagination:{first:0,rows:5,sort:null},keySearch:""},tableSelection:[]}),I=[{title:"Tất cả"},{title:"Dự thảo"},{title:"Đang hoạt động"},{title:"Tạm ngưng"}],V=z(()=>D.value),d=o=>{switch(t.tabIndex){case 0:return["active","pause"].includes(o);case 1:return["draft"].includes(o);case 2:return["pause"].includes(o);case 3:return["active"].includes(o)}},c=o=>t.tableSelection.map(n=>n[o]),f=o=>!c("status_code").includes(o),L=()=>{switch(t.tabIndex){case 0:return"";case 1:return"DRAFT";case 2:return"ACTIVE";case 3:return"PAUSE"}},u=()=>{y({status:L(),key_search:t.body.keySearch})},R=()=>{t.body.keySearch="",t.tableSelection=[],u()},C=()=>{t.body.keySearch&&u()},T=o=>{x.require({message:`Bạn muốn ${o==="pause"?"tạm ngưng":"mở lại"} ${t.tableSelection.length} sản phẩm?`,header:"Xác nhận",icon:"pi pi-info-circle",acceptLabel:"Đồng ý",acceptClass:"p-button-danger",rejectLabel:"Hủy bỏ",rejectClass:"p-button-outlined",accept:async()=>{if(c("status_code").includes(o==="pause"?"PAUSE":"ACTIVE")||c("status_code").includes("DRAFT")){P.error(`Vui lòng chỉ chọn dòng dữ liệu có trạng thái: ${o==="pause"?"Hoạt động":"Tạm ngưng"}`);return}(await A({ids:c("product_id"),status:o==="pause"?"PAUSE":"ACTIVE"})).success&&(t.tableSelection=[],u())}})},E=o=>{_.push({name:"ProductDetailAdmin",params:{id:o.data.product_id}})};return J(()=>{y()}),(o,n)=>{const p=i("Button"),B=i("InputText"),r=i("Column"),U=i("StatusComponent"),$=i("DataTable"),F=i("TabPanel"),K=i("TabView"),M=i("ConfirmDialog");return v(),S(k,null,[a("div",ee,[te,s(K,{activeIndex:t.tabIndex,"onUpdate:activeIndex":n[6]||(n[6]=m=>t.tabIndex=m),onTabChange:R},{default:l(()=>[(v(),S(k,null,Q(I,(m,N)=>s(F,{key:N,header:m.title},{default:l(()=>[s($,{paginator:!0,selection:t.tableSelection,"onUpdate:selection":n[4]||(n[4]=e=>t.tableSelection=e),value:V.value,first:t.body.pagination.first,rows:t.body.pagination.rows,rowsPerPageOptions:[5,10,15,20],paginatorTemplate:" FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",currentPageReportTemplate:"Hiển thị {first} - {last} / tổng {totalRecords} dòng",onRowDblclick:n[5]||(n[5]=e=>E(e))},{header:l(()=>[a("div",ne,[a("div",se,[h(s(p,{label:"Thêm bản dự thảo",onClick:n[0]||(n[0]=e=>g(_).push({name:"ProductDetailAdmin",params:{id:"create"}}))},null,512),[[b,d("draft")]]),h(s(p,{label:"Mở lại",disabled:f("PAUSE"),onClick:n[1]||(n[1]=e=>T("active"))},null,8,["disabled"]),[[b,d("active")]]),h(s(p,{label:"Tạm ngưng",class:"p-button-danger",disabled:f("ACTIVE"),onClick:n[2]||(n[2]=e=>T("pause"))},null,8,["disabled"]),[[b,d("pause")]])]),a("span",oe,[a("i",{class:W([{"p-disabled":!t.body.keySearch},"pi pi-search on-click"]),onClick:C},null,2),s(B,{modelValue:t.body.keySearch,"onUpdate:modelValue":n[3]||(n[3]=e=>t.body.keySearch=e),placeholder:"Tìm theo tên sản phẩm",size:"small",class:"w-full",maxLength:"35",onKeypress:X(C,["enter"])},null,8,["modelValue","onKeypress"])])])]),empty:l(()=>[ie]),default:l(()=>[s(r,{selectionMode:"multiple",class:"max-w-5rem w-5rem"}),s(r,{field:"product_code",header:"Mã sản phẩm",headerClass:"white-space-nowrap",style:{"min-width":"7rem"},sortable:!0}),s(r,{field:"image",header:"Ảnh sản phẩm",headerClass:"white-space-nowrap",style:{"min-width":"10rem"},sortable:!0},{body:l(({data:e})=>[a("div",ae,[a("img",{class:"h-4rem",src:e.image,alt:"Lỗi ảnh"},null,8,le)])]),_:1}),s(r,{field:"name",header:"Tên sản phẩm",headerClass:"white-space-nowrap",style:{"min-width":"20rem"},sortable:!0}),s(r,{field:"price",header:"Giá sản phẩm",headerClass:"white-space-nowrap",style:{"min-width":"10rem"},sortable:!0},{body:l(({data:e})=>[a("span",null,w(g(Y)(e==null?void 0:e.price)),1)]),_:1}),s(r,{field:"sale",header:"Phần trăm giảm",headerClass:"white-space-nowrap",style:{"min-width":"10rem"},sortable:!0},{body:l(({data:e})=>[a("span",re,w(e==null?void 0:e.sale),1)]),_:1}),s(r,{field:"created_at",header:"Ngày tạo",headerClass:"white-space-nowrap",style:{"min-width":"10rem"},sortable:!0},{body:l(({data:e})=>[a("span",null,w(g(Z)(e==null?void 0:e.created_at)),1)]),_:1}),s(r,{field:"status_code",header:"Trạng thái",headerClass:"white-space-nowrap",style:{"min-width":"10rem"},sortable:!0},{body:l(({data:e})=>[s(U,{code:e==null?void 0:e.status_code},null,8,["code"])]),_:1})]),_:1},8,["selection","value","first","rows"])]),_:2},1032,["header"])),64))]),_:1},8,["activeIndex"])]),s(M,{class:"line-height-3"})],64)}}};export{ue as default};
